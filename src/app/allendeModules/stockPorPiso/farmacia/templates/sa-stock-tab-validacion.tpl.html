<div class="row">
	<h4>Busqueda</h4>
	<sa-ubicacion-piso
		sucursal="sucursal"
		changed="ubicacionChanged(ubicacion)"
		limpiar="formControl.limpiar">
	</sa-ubicacion-piso>
	<!-- <div class="row" ng-if="filter.internadoSeleccionado != null">
		<div class="col-xs-12">
			<label class="text-center" > Mutual:  {{filter.internadoSeleccionado.NombreMutual}} - Nro Afiliado:  {{filter.internadoSeleccionado.NumeroAfiliado}} - Fecha Ingreso: {{filter.internadoSeleccionado.FechaAdmision | date:"dd/MM/yyyy HH:mm"}}</label >
		</div>		
	</div>
	<div class="row" ng-if="filter.internadoSeleccionado != null">
		<div class="col-xs-12">
			<label class="text-center" > Diagn贸stico: {{filter.internadoSeleccionado.Diagnostico}} </label>
		</div>
	</div> -->
	<div ng-hide="formControl.guardia">
		<div class="col-xs-12 col-sm-6 col-md-4 col-lg-4 " id="ubicacion">
			<label for="internado_select">Internados</label>
			<div class="input-group">
				<select id="internado_select"
						class="form-control"
						ng-disabled="!formControl.ubicacionCargada || formControl.loading"
						ng-model="formData.internacion"
						ng-change="internacionChanged()">
				  			<option ng-repeat="internado in data.internaciones  track by internado.NumeroInternado"
				  					
									ng-class="internado.color">{{internado.NumeroInternado}} || {{internado.NombrePaciente}} || Hab: {{internado.NumeroHabitacion}} Cama: {{internado.NumeroCama}}</option>	 
				</select>
				<span class="input-group-btn">
					<button id="limpiarCarga_button" type="button" 
							class="btn btn-default"
							ng-disabled="!formControl.ubicacionCargada || formControl.loading"
							uib-tooltip="Recargar" 
							uib-tooltip-placement="top"
							ng-click="ubicacionChanged(data.ubicacion)">
						<sa-icon name="REPEAT"></sa-icon>
					</button>
				</span>
			</div>
		</div>
		<div class="col-xs-2 col-sm-4 col-md-2 col-lg-2">
			<span class="btn-group btn-group pull-right">
				<button id="limpiarCarga_button" type="button" 
						class="btn btn-default"
						uib-tooltip="Limpiar Cargas" 
						uib-tooltip-placement="top"
						ng-click="limpiar()">
					<sa-icon name="REPEAT"></sa-icon>
				</button>
				<button id="print_button" type="button" 
						class="btn btn-default"
						uib-tooltip="Imprimir" 
						ng-disabled="!formControl.ubicacionCargada || formControl.loading"
						uib-tooltip-placement="top"
						ng-click="printEntrega()">
					<sa-icon name="PRINT"></sa-icon>
				</button>
				<button id="print" type="button" 
						class="btn btn-default "
						uib-tooltip="Entregar" 
						ng-disabled="!formControl.ubicacionCargada || formControl.loading"
						uib-tooltip-placement="top"
						ng-click="entregar()">
						Entregar
				</button>
				<!-- <button id="print" type="button" 
						class="btn btn-default btn-row-right"
						uib-tooltip="Imprimir" 
						uib-tooltip-placement="top"
						ng-click="print()">
					<sa-icon name="PRINT"></sa-icon>
				</button> -->
			</span>
		</div>		
		<div class="col-xs-12 col-sm-3 col-md-2 col-lg-2 form-group pull-right">
			<label >Color Internados</label>
			<table class="table table-bordered table-condensed">
				<tbody>
					<tr ng-repeat="estado in data.estadosInternacion">
						<td>
							<div class="pull-left">
								<div class="circulito" ng-class="estado.color"></div>
							</div>
							&nbsp;&nbsp;{{ estado.nombre}}
						</td>
					</tr>
				</tbody>
			</table>
		</div>
	</div>

	<div ng-hide="!formControl.guardia">
		<div class="col-xs-12 col-sm-6 col-md-4 col-lg-4 " id="ubicacion">
			<label for="paciente_select">Pacientes</label>
			<div class="input-group">
				<select id="paciente_select"
						class="form-control"
						ng-disabled="!formControl.ubicacionCargada || formControl.loading"
						ng-model="formData.paciente"
						ng-change="pacienteChanged()"
						ng-options="paciente.Nombre 
									for paciente in data.pacientesGuardia 
									track by paciente.Id"
									>
				  			<!-- <option ng-repeat="paciente in data.pacientesGuardia  track by paciente.Id"
				  					ng-value="paciente" 
									ng-class="paciente.Color">{{paciente.Nombre}}</option>	  -->
				</select>
				<span class="input-group-btn">
					<button id="limpiarCarga_button" type="button" 
							class="btn btn-default"
							ng-disabled="!formControl.ubicacionCargada || formControl.loading"
							uib-tooltip="Recargar" 
							uib-tooltip-placement="top"
							ng-click="ubicacionChanged(data.ubicacion)">
						<sa-icon name="REPEAT"></sa-icon>
					</button>
				</span>
			</div>
		</div>
		<div class="col-xs-2 col-sm-4 col-md-2 col-lg-2">
			<span class="btn-group btn-group pull-right">
				<button id="limpiarCarga_button" type="button" 
						class="btn btn-default"
						uib-tooltip="Limpiar Cargas" 
						uib-tooltip-placement="top"
						ng-click="limpiar()">
					<sa-icon name="REPEAT"></sa-icon>
				</button>
				<button id="print" type="button" 
						class="btn btn-default "
						uib-tooltip="Entregar" 
						ng-disabled="!formControl.ubicacionCargada || formControl.loading"
						uib-tooltip-placement="top"
						ng-click="entregarGuardia()">
						Entregar
				</button>
				<!-- <button id="print" type="button" 
						class="btn btn-default btn-row-right"
						uib-tooltip="Imprimir" 
						uib-tooltip-placement="top"
						ng-click="print()">
					<sa-icon name="PRINT"></sa-icon>
				</button> -->
			</span>
		</div>
	</div>
</div>
<div class="row fila text-center" ng-if="filter.internadoSeleccionado != null">
	<label class="text-center" > Mutual:  {{filter.internadoSeleccionado.NombreMutual}} - Nro Afiliado:  {{filter.internadoSeleccionado.NumeroAfiliado}} - Fecha Ingreso: {{filter.internadoSeleccionado.FechaAdmision | date:"dd/MM/yyyy"}} - Diagn贸stico: {{filter.internadoSeleccionado.Diagnostico}}</label >	
</div>
<div class="row fila" ng-hide="!formControl.internacionCargada">
	<h4>Filtros</h4>
	<div class="col-xs-12 col-sm-4 col-md-3 col-lg-2">
		<label for="tipo_button" >Tipo</label>
		<button id="tipo_button" class="btn btn-default btn-block" type="button"
				ng-click="changeBotonTipo()">
				{{formData.boton_tipo.nombre}}
		</button>
	</div>
	<div class="col-xs-12 col-sm-4 col-md-3 col-lg-2 ">
		<label for="estado_select" >Estado</label>
		<select id="estado_select" class="form-control"
			ng-model="filter.estado"
			ng-change="getPage()"
			ng-options="estado.nombre_estado 
			for estado in data.estados 
			track by estado.id_estado" 
			required >
			<option value="">--Todos--</option>
		</select>
	</div>
	<div class="col-xs-12 col-sm-4 col-md-3 col-lg-2 ">
		<label for="fecha_button">Fecha</label>
		<button id="fecha_button" class="btn btn-default btn-block" type="button"
				ng-click="changeBotonFecha()">
				{{formData.boton_fecha.nombre}}
		</button>
	</div>

	<div class="col-xs-12 col-sm-4 col-md-3 col-lg-2 pull-right ">
		<!-- <label for="fecha_button">Fecha</label> -->
		<button id="fecha_button" class="btn btn-default btn-block btn-row" type="button"
				ng-click="entregarDescartables()">
				Entregar Descartables
		</button>
	</div>
</div>

<table class="table table-hover" id="dosificaciones_table" ng-hide="formControl.loading || !formData.boton_tipo.esIndicacion || formControl.guardia">
	<thead>
		<tr >
			<th colspan="3" class="text-center"></th>
		</tr>
		<!-- <tr class="thead-azul"> -->
		<tr class="cabecera-tabla">
			<th class="text-left">Codigo</th>
			<th class="text-left">Descripcion</th>
			<th class="text-left">Presentacion</th>
			<th class="text-left">Monodroga Indicada</th>
			<!-- <th class="text-left">Destino</th> -->
			<!-- <th class="text-left">Usuario Solicita</th> -->
			<th class="text-center">Duplica</th>
			<th class="text-left">Fecha/Hora</th>
			<th class="text-center">Estado</th>
			<th class="text-center">Detalle</th>
		</tr>
	</thead>
	<tbody ng-hide="!formControl.ubicacionCargada || formControl.vacio">
		<tr ng-repeat="pedido in filter.dosificaciones">
			<th class="row text-left">{{ pedido.Material.numero_articulo }}</th>
			<th class="row text-left">{{ pedido.Material.nombre }}</th>
			<th class="row text-left">{{ pedido.Material.presentacion }}</th>
			<th class="row text-left">{{ pedido.NombreDroga }}</th>
			<!-- <th class="row text-left">{{ pedido.Internacion.numero_internado }} || {{ pedido.Internacion.Paciente.nombre_completo }}</th> -->
			<!-- <th class="row text-left">{{ pedido.Medico.NombreCompleto }}</th> -->
			<th class="row text-center">{{ pedido.duplica }}</th>
			<td	class="row text-left">{{ pedido.fecha_hora | date:"dd/MM/yyyy HH:mm"}}</td>
			<td	class="row text-center" ng-class="pedido.Estado.color">{{ pedido.Estado.nombre_estado}}</td>
			<td class="text-center" ng-hide="pedido.descartable == 1">
				<button type="button" 
						class="btn btn-white btn-xs"
						uib-tooltip="Entregar" 
						uib-tooltip-placement="top"
						ng-click="verDetalleDosificacion(pedido)">
					<sa-icon name="LIST"></sa-icon>
				</button>
				<!-- ToDo: @emansilla: se deshabilita bot贸n cambiar producto dosificaci贸n -->
				<button type="button" 
						ng-if="pedido.puedeCambiarProducto"
						class="btn btn-white btn-xs"
						uib-tooltip="Cambiar Producto" 
						uib-tooltip-placement="top"
						ng-click="cambiarProductoDosif(pedido)">
					<sa-icon name="EDIT"></sa-icon>
				</button>
			</td>
			<td	class="row text-center" ng-hide="pedido.descartable != 1">Cantidad: {{pedido.cantidad_entregada}}</td>
		</tr>
	</tbody>
</table>

<table class="table table-hover" id="infusiones_table" ng-hide="formControl.loading || formData.boton_tipo.esIndicacion || formControl.guardia">
	<thead>
		<tr >
			<th colspan="3" class="text-center"></th>
		</tr>
		<!-- <tr class="thead-azul"> -->
		<tr class="cabecera-tabla">
			<th class="text-left">Infusion</th>
			<th class="text-left">Goteo</th>
			<!-- <th class="text-left">Presentacion</th> -->
			<!-- <th class="text-left">Destino</th> -->
			<!-- <th class="text-left">Usuario Solicita</th> -->
			<th class="text-center">Duplica</th>
			<th class="text-left">Fecha/Hora</th>
			<th class="text-left">Suministrado</th>
			<th class="text-left">Estado</th>			
			<th class="text-left">Detalle</th>
		</tr>
	</thead>
	<tbody ng-hide="!formControl.ubicacionCargada || formControl.vacio" ng-repeat="infusion in filter.infusiones" ng-click="verAgregados(infusion)">
		<tr >
			<th class="row text-left">{{ infusion.infusion}}</th>
			<th class="row text-left">{{ infusion.goteo }} {{infusion.unidad_medida}}</th>
			<!-- <th class="row text-left">{{ infusion.Material.presentacion }}</th> -->
			<th class="row text-center">{{ infusion.duplica }}</th>
			<td	class="row text-left">{{ infusion.fecha_hora | date:"dd/MM/yyyy HH:mm"}}</td>
			<td	class="row text-left">{{ infusion.EstaSuministrado}}</td>
			<td	class="row text-left" ng-class="infusion.Estado.color">{{ infusion.Estado.nombre_estado}}</td>			
			<td class="text-left">
				<button id="cargarProducto_button"
						type="button" 
						class="btn btn-white btn-xs"
						uib-tooltip="Entregar" 
						ng-hide="infusion.noAgregados"
						uib-tooltip-placement="top"
						ng-click="verDetalleInfusion(infusion)">
					<sa-icon name="LIST"></sa-icon>
				</button>
			</td>
		</tr>
		<tr ng-hide="!infusion.verAgregados" >
			<td colspan="7">
				<div class="span9">
					<div class="col-md-11">
						<!-- Second Layer -->
						<table class="table table-hover table-condensed table-striped" ng-hide="infusion.noAgregados">
							<thead class="levelTwo">
								<tr></tr>
								<tr class="cabecera-tabla-celeste">
								 	<th>Codigo</th>
									<th>Descripcion</th>
									<th>Presentacion</th>
									<th>Monodroga Indicada</th>
									<th>Estado</th>
								</tr>
							</thead>
							<tbody>
								<tr ng-repeat="agregado in infusion.Agregados">
									<td ng-bind="agregado.Material.numero_articulo"></td>
									<td ng-bind="agregado.Material.nombre"></td>
									<td ng-bind="agregado.Material.presentacion"></td>
									<td ng-bind="agregado.NombreDroga"></td>
									<td ng-class="agregado.Estado.color" ng-bind="agregado.Estado.nombre_estado"></td>
									<td>
										<button type="button" 
												ng-if="agregado.puedeCambiarProducto"
												class="btn btn-white btn-xs"
												uib-tooltip="Cambiar Producto" 
												uib-tooltip-placement="top"
												ng-click="cambiarProductoAgregado(infusion, agregado)">
											<sa-icon name="EDIT"></sa-icon>
										</button>
									</td>
								</tr>
							</tbody>
						</table>
						<div class="col-xs-12 col-sm-6 col-md-3 col-lg-12 text-center" ng-hide="!infusion.verAgregados || !infusion.noAgregados" >
							<label  >No hay agregados..</label>
						</div>
						<!-- End Second Layer -->

					</div>
				</div>
			</td>
		</tr>
	</tbody>
</table>

<table class="table table-hover" id="guardia_table" ng-hide="formControl.loading || !formControl.guardia">
	<thead>
 		<tr >
			<th colspan="3" class="text-center"></th>
		</tr>
		<tr class="thead-azul">
		<tr class="cabecera-tabla"> 
			<th style="width: 40%;" class="text-left">Profesional Solicito</th>
			<th style="width: 30%;" class="text-left">Fecha Hora</th>
			
			<th style="width: 30%;" class="text-center">Agregar</th>
		</tr>
	</thead>
	<tbody ng-repeat="pedido in formData.paciente.Pedidos"  ng-hide="formControl.loading || formControl.vacio">
		<tr>
			<td ng-click="verDetalleGuardia([$index])" class="row text-left">{{ pedido.ProfesionalSolicita}}</td>
			<td ng-click="verDetalleGuardia([$index])" class="row text-left">{{ pedido.FechaCarga | date:"dd/MM/yyyy HH:mm"}}</td>
			<td class="text-center" width="250">
				<div class="input-group">
					<input ng-show="pedido.nuevoProducto" 
							type="text" 
							class="form-control input-sm" placeholder="Nuevo producto..." 
							ng-model="formData.productoNuevo"
							ng-disabled=""
							uib-typeahead="producto as (producto.nombre +' * '+ producto.presentacion) for producto in data.materiales | filter:$viewValue | limitTo:8" 
							class="form-control no-valid"
							typeahead-on-select="cargarProducto([$index])"
							ng-change=""
							typeahead-select-on-exact="true">
					<span class="input-group-btn">
						<button id="cargarProducto_button"
								type="button" 
								ng-disabled="!pedido.verDetalle"
								class="btn btn-white btn-xs"
								uib-tooltip="Agregar" 
								uib-tooltip-placement="top"
								ng-click="nuevoProducto([$index])">
							<sa-icon name="NEW"></sa-icon>
						</button>
					</span>
				</div>
			</td>
		</tr>
		<tr ng-hide="!pedido.verDetalle" >
			<td colspan="7">
				<div class="span9">
					<div class="col-md-10 col-md-offset-1">
						<!-- Second Layer -->
						<table class="table table-hover table-condensed table-striped">
							<thead class="levelTwo">
								<tr></tr>
								<tr class="cabecera-tabla-celeste">
									<th>Codigo</th>
									<th>Descripcion</th>
									<th>Presentacion</th>
									<th ng-if="!pedido.Urgencia" >Dosis</th>
									<th ng-if="!pedido.Urgencia" >Tipo Dosis</th>
									<th ng-if="!pedido.Urgencia" >Via</th>
									<th ng-if="pedido.Urgencia" >Cantidad Pedida</th>
									<th style="width: 10%;">Cantidad a Entregar</th>
								</tr>
							</thead>
							<tbody>
								<tr ng-repeat="detalle in pedido.Detalles">
									<td ng-bind="detalle.Material.NumeroArticulo"></td>
									<td ng-bind="detalle.Material.Nombre"></td>
									<td ng-bind="detalle.Material.Presentacion"></td>
									<td ng-if="!pedido.Urgencia"  ng-bind="detalle.Dosis"></td>
									<td ng-if="!pedido.Urgencia"  ng-bind="detalle.TipoDosis"></td>
									<td ng-if="!pedido.Urgencia"  ng-bind="detalle.Via"></td>
									<td ng-if="pedido.Urgencia"  ng-bind="detalle.CantidadPedida"></td>
									<td>
										<div class="input-group">
										  <span class="input-group-btn">
											  <button type="button" 
													ng-hide=""
													class="btn btn-white btn-xs"
													ng-disabled="detalle.minimo"
													ng-click="resta(pedido, detalle)">
													<sa-icon name="MINUS"></sa-icon>
											</button>
										  </span>
										  <input type="text" min="0"
										  			class="form-control input-sm"
													ng-model="detalle.Cantidad"
													ng-disabled="true"
													required>
										  <span class="input-group-btn">
											  <button type="button"
													ng-hide=""
													class="btn btn-white btn-xs"
													ng-click="suma(pedido, detalle)">
													<sa-icon name="NEW"></sa-icon>
											</button>
										  </span>
									  </div>	
									</td>
								</tr>
							</tbody>
						</table>
						<!-- End Second Layer -->
					</div>
				</div>
			</td>
		</tr>
		<tr>
		</tr>
	</tbody>
</table>

<div class="col-xs-12 text-center" ng-hide="!formControl.vacio" >
	<label>No hay productos cargados</label>
</div>
<sa-loading ng-if="formControl.loading"></sa-loading>

